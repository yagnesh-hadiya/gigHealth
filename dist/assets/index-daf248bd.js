import{b as E,r,c as s,g as D,f as u,l as I,aQ as L,L as H,C as T,aR as k,aU as A,bn as B,H as n,d as F,bo as M,aW as z,aX as P,bp as Q,bq as W}from"./index-e391d606.js";const U=()=>{const g=E(),[d,t]=r.useState(!1),[h,x]=r.useState([]),[c,p]=r.useState(""),[b,f]=r.useState(!1),i=new AbortController,m=A(async()=>{try{t(!0);const e=await B(c,i);t(!1),x(e)}catch(e){if(i.signal.aborted){f(!0);return}console.error(e),t(!1),n("error",e.response.message||"Something went wrong")}},300);r.useEffect(()=>(m(),()=>i.abort()),[c,b]);const j=async e=>{try{t(!0);const a=h.find(o=>o.Id===e),l=await Q(e);if(a!==void 0){const{role:o,description:S,allows:v}=l,{IsRoleNameEditable:y,IsPermissionsEditable:N}=a;g(`/role/edit/${e}`,{state:{role:o,description:S,allows:v,IsRoleNameEditable:y,IsPermissionsEditable:N}}),t(!1)}else t(!1),n("error","Role not found")}catch(a){console.error(a),n("error","Something went wrong")}},w=async e=>{var a,l;try{t(!0);const o=await W(e);n("success","Role Deleted Successfully"),t(!1),t(!0),await m(),t(!1)}catch(o){console.error(o),t(!1),n("error",((l=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:l.message)||"Something went wrong")}},R=[{name:"Sr No",cell:(e,a)=>a+1||e.Id,width:"8%"},{name:"Role Type",cell:e=>s.jsx("span",{style:{fontWeight:"600"},children:e.Role.split(" ").map(a=>F(a)).join(" ")}),width:"15%"},{name:"Description",cell:e=>M(e.Description),width:"68%"},{name:"Actions",cell:e=>s.jsxs(s.Fragment,{children:[s.jsx(z,{onEdit:()=>{j(e.Id)}}),e.IsRoleDeletable&&s.jsx(P,{onDelete:()=>{w(e.Id)}})]}),width:"7%"}],C=e=>{p(e)};return s.jsxs(s.Fragment,{children:[s.jsx("h1",{className:"list-page-header",children:"Role Management"}),s.jsxs(D,{children:[s.jsx("div",{children:s.jsxs("div",{className:"d-flex mb-3 search-button",children:[d&&s.jsx(u,{}),s.jsxs("div",{className:"search-bar-wrapper flex-grow-1",children:[s.jsx(I,{placeholder:"Search Here",value:c,onChange:e=>{C(e.target.value)}}),s.jsx("img",{src:L,alt:"search"})]}),s.jsx("div",{className:"table-navigate",children:s.jsx(H,{to:"/roles/create",className:"link-button",children:s.jsx(T,{className:"primary-btn",children:"Create New Role"})})})]})}),s.jsx("div",{className:"datatable-wrapper",children:s.jsx(k,{columns:R,data:h,progressPending:d,progressComponent:s.jsx(u,{styles:{backgroundColor:"white",zIndex:"9999"}})})})]})]})};export{U as default};
