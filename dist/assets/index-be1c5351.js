import{bw as $,bx as B,r as c,u as G,E as q,d as M,c as e,by as w,f as z,e as P,R as Q,h as E,k as L,l as R,m as H,s as U,b8 as W,C as I,bz as Y,H as j,bA as Z,g as V,aQ as X,B as A,aR as J,aU as K,bB as k,bo as O,aW as _,aX as ee,bC as se}from"./index-e391d606.js";let ae=$({name:B().required("Document Name is required").typeError("Document Name must be of type String").min(2,"Document Name must be at least 2 characters").max(100,"Document Name must be at most 100 characters").test("is-string","Document Name should only be a string",t=>t?/^[A-Za-z ]+$/.test(t):!1),description:B().optional().nullable().test("description","Description must be between 2 to 255 characters",t=>t==null||t===""?!0:t.length>=2&&t.length<=255&&/^[a-zA-Z ']+$/.test(t))});const te=({setIsOffCanvasOpen:t,isOffCanvasOpen:f,selectedDocumentForEdit:o,setSelectedDocumentForEdit:d,fetchData:b})=>{var D,s;const[m,u]=c.useState(!1),[x,h]=c.useState("false"),S=a=>h(a),{register:g,handleSubmit:y,formState:{errors:r},reset:p,setValue:C}=G({resolver:q(ae)});c.useEffect(()=>{if(o){const{Type:a,Description:l,IsCoreCompliance:n}=o,i=a?a.split(" ").map(N=>M(N)).join(" "):"";C("name",i),C("description",M(l)),h(n===!0?"true":"false")}else p()},[o]);const T=async a=>{var l,n;try{const{name:i,description:N}=a;if(o){const F=o.Id;u(!0),await Y(F,i,N,x==="true"),u(!1),b(),t(!1),d(null),j("success","Document type updated successfully!")}else u(!0),await Z(i,N,x==="true"),u(!1),b(),t(!1),p(),j("success","Document type created successfully!")}catch(i){console.error(i),u(!1),j("error",((n=(l=i==null?void 0:i.response)==null?void 0:l.data)==null?void 0:n.message)||"Something went wrong")}},v=()=>{t(!1),p(),d(null)};return e.jsx("div",{className:"offcanvas-wrapper",children:e.jsxs(w,{show:f,onHide:()=>{t(!1),p(),d(null)},placement:"end",children:[e.jsx(w.Header,{closeButton:!0,children:e.jsxs(w.Title,{children:[" ",o?"Edit Document Type":"Add Document Type"]})}),e.jsxs(w.Body,{children:[m&&e.jsx(z,{}),e.jsxs(P,{onSubmit:y(T),children:[e.jsxs(Q,{children:[e.jsxs(E,{md:"12",className:"col-group",children:[e.jsxs(L,{className:"",children:["Document Type Name ",e.jsx("span",{className:"asterisk",children:"*"})]}),e.jsx(R,{id:"DocumentTypeName",placeholder:"Document Type Name",invalid:!!r.name,...g("name")}),e.jsx(H,{children:(D=r.name)==null?void 0:D.message})]}),e.jsxs(E,{md:"12",className:"col-group",children:[e.jsx(L,{children:"Description"}),e.jsx(U,{id:"Description",placeholder:"Description",invalid:!!r.description,...g("description")}),e.jsx(H,{children:(s=r.description)==null?void 0:s.message})]}),e.jsxs(E,{xxl:"6",xl:"6",lg:"6",md:"6",className:"col-group",children:[e.jsx(L,{className:"",children:"Is Core Compliance?"}),e.jsx("table",{className:"w-100",children:e.jsx("tbody",{className:"m-4",children:e.jsx("td",{children:e.jsx("span",{children:e.jsx(W,{options:[{label:"Yes",value:"true"},{label:"No",value:"false"}],name:"coreCompliance",onChange:a=>S(a),selected:x})})})})})]})]}),e.jsxs("div",{className:"btn-wrapper",children:[e.jsx(I,{className:"primary-btn",children:"Save"}),e.jsx(I,{className:"secondary-btn",onClick:v,children:"Cancel"})]})]})]})]})})},re=()=>{const[t,f]=c.useState(!1),[o,d]=c.useState([]),[b,m]=c.useState(!1),[u,x]=c.useState(null),[h,S]=c.useState(""),[g,y]=c.useState(!1),r=new AbortController,p=K(async()=>{try{m(!0);const s=await k(h,r);m(!1),d(s)}catch(s){if(r.signal.aborted){y(!0);return}console.error(s),m(!1),j("error",s.response.message||"Something went wrong")}},500);c.useEffect(()=>(p(),()=>r.abort()),[h,g]);const C=async s=>{var a,l;try{m(!0),await se(s);const n=await k(h,r);m(!1),d(n),j("success","Document type deleted successfully")}catch(n){if(r.signal.aborted){y(!0);return}console.error("Error",n),m(!1),j("error",((l=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:l.message)||"Something went wrong")}},T=s=>{const a=o.find(l=>l.Id===s);a!==void 0&&(x(a),f(!0))},v=s=>{S(s)},D=[{name:"Sr No",cell:(s,a)=>e.jsx("span",{style:{marginLeft:"10px"},children:a+1||s.Id}),width:"10%"},{name:"Document Type",cell:s=>e.jsx("span",{style:{fontWeight:"600"},children:s.Type?s.Type.split(" ").map(a=>M(a)).join(" "):""}),width:"20%"},{name:"IsCoreCompliance",cell:s=>e.jsx("span",{style:{marginLeft:"20px"},children:s.IsCoreCompliance===!0?"Yes":"No"}),width:"20%"},{name:"Description",cell:s=>O(s.Description)},{name:"Actions",cell:s=>e.jsxs(e.Fragment,{children:[e.jsx(A,{submodule:"",module:"documentmaster",action:["GET","PUT"],children:e.jsx(_,{onEdit:()=>T(s.Id)})}),e.jsx(A,{submodule:"",module:"documentmaster",action:["GET","DELETE"],children:e.jsx(ee,{onDelete:()=>C(s.Id)})})]}),width:"10%"}];return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"list-page-header",children:"Document Master"}),e.jsxs(V,{children:[e.jsxs("div",{className:"d-flex mb-3 search-button",children:[e.jsxs("div",{className:"search-bar-wrapper flex-grow-1",children:[e.jsx(R,{placeholder:"Search Here",value:h,onChange:s=>{v(s.target.value)}}),e.jsx("img",{src:X,alt:"search"})]}),e.jsx("div",{className:"table-navigate",children:e.jsx(A,{submodule:"",module:"documentmaster",action:["GET","POST"],children:e.jsx(I,{className:"primary-btn",onClick:()=>f(!0),children:"Add Document Type"})})})]}),e.jsx("div",{className:"datatable-wrapper",children:b?e.jsx(z,{}):e.jsx(J,{columns:D,data:o})})]}),e.jsx(te,{setIsOffCanvasOpen:f,isOffCanvasOpen:t,setDocumentMasterList:d,selectedDocumentForEdit:u,setSelectedDocumentForEdit:x,fetchData:p})]})};export{re as default};
